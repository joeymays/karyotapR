<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Get read counts from barcoded reads — countBarcodedReads • karyotapR</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get read counts from barcoded reads — countBarcodedReads"><meta name="description" content="countBarcodedReads() and countBarcodedReadsFromContig() match exogenous DNA barcode sequences to their associated
cell barcodes and saves them to the colData (cell barcode metadata) of TapestriExperiment.
countBarcodedReads() is a shortcut for countBarcodedReadsFromContig(), allowing the user to specify 'gRNA' or 'barcode'
to use the grnaCounts or barcodeCounts altExp slots.
The entries in the barcode.lookup table do not have to be present in the sample,
allowing users to keep one master table/file of available barcode sequences for use in all experiments.
The Rsamtools and Biostrings packages must be installed to use these functions."><meta property="og:description" content="countBarcodedReads() and countBarcodedReadsFromContig() match exogenous DNA barcode sequences to their associated
cell barcodes and saves them to the colData (cell barcode metadata) of TapestriExperiment.
countBarcodedReads() is a shortcut for countBarcodedReadsFromContig(), allowing the user to specify 'gRNA' or 'barcode'
to use the grnaCounts or barcodeCounts altExp slots.
The entries in the barcode.lookup table do not have to be present in the sample,
allowing users to keep one master table/file of available barcode sequences for use in all experiments.
The Rsamtools and Biostrings packages must be installed to use these functions."><meta property="og:image" content="http://joeymays.xyz/karyotapR/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">karyotapR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/karyotapR.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/barcoding.html">Barcoding and gRNA Probes</a></li>
    <li><a class="dropdown-item" href="../articles/GMMs-for-Copy-Number-Calling.html">GMMs for Copy Number Calling</a></li>
    <li><a class="dropdown-item" href="../articles/TapExp-navigation.html">Navigating the TapestriExperiment Class</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/joeymays/karyotapR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Get read counts from barcoded reads</h1>
      <small class="dont-index">Source: <a href="https://github.com/joeymays/karyotapR/blob/master/R/parseBarcodedReads.R" class="external-link"><code>R/parseBarcodedReads.R</code></a></small>
      <div class="d-none name"><code>countBarcodedReads.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>countBarcodedReads()</code> and <code>countBarcodedReadsFromContig()</code> match exogenous DNA barcode sequences to their associated
cell barcodes and saves them to the <code>colData</code> (cell barcode metadata) of <code>TapestriExperiment</code>.
<code>countBarcodedReads()</code> is a shortcut for <code>countBarcodedReadsFromContig()</code>, allowing the user to specify 'gRNA' or 'barcode'
to use the <code>grnaCounts</code> or <code>barcodeCounts</code> <code>altExp</code> slots.
The entries in the <code>barcode.lookup</code> table do not have to be present in the sample,
allowing users to keep one master table/file of available barcode sequences for use in all experiments.
The <code>Rsamtools</code> and <code>Biostrings</code> packages must be installed to use these functions.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">countBarcodedReads</span><span class="op">(</span></span>
<span>  <span class="va">TapestriExperiment</span>,</span>
<span>  <span class="va">bam.file</span>,</span>
<span>  <span class="va">barcode.lookup</span>,</span>
<span>  <span class="va">probe</span>,</span>
<span>  return.table <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  max.mismatch <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  with.indels <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">countBarcodedReadsFromContig</span><span class="op">(</span></span>
<span>  <span class="va">bam.file</span>,</span>
<span>  <span class="va">barcode.lookup</span>,</span>
<span>  <span class="va">contig</span>,</span>
<span>  cell.barcode.tag <span class="op">=</span> <span class="st">"RG"</span>,</span>
<span>  max.mismatch <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  with.indels <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-tapestriexperiment">TapestriExperiment<a class="anchor" aria-label="anchor" href="#arg-tapestriexperiment"></a></dt>
<dd><p><code>TapestriExperiment</code> object</p></dd>


<dt id="arg-bam-file">bam.file<a class="anchor" aria-label="anchor" href="#arg-bam-file"></a></dt>
<dd><p>File path of BAM file. <code>.bai</code> BAM index file must be in the same location (can be generated using <code><a href="https://rdrr.io/pkg/Rsamtools/man/scanBam.html" class="external-link">Rsamtools::indexBam()</a></code>).</p></dd>


<dt id="arg-barcode-lookup">barcode.lookup<a class="anchor" aria-label="anchor" href="#arg-barcode-lookup"></a></dt>
<dd><p><code>data.frame</code> where the first column is the barcode identifier/name and the second column is the DNA sequence. Headers are ignored.</p></dd>


<dt id="arg-probe">probe<a class="anchor" aria-label="anchor" href="#arg-probe"></a></dt>
<dd><p>Character, either "gRNA" or "barcode" to parse counts from <code>grnaCounts</code> or <code>barcodeCounts</code> <code>altExp</code> slots, respectively.</p></dd>


<dt id="arg-return-table">return.table<a class="anchor" aria-label="anchor" href="#arg-return-table"></a></dt>
<dd><p>Logical, if <code>TRUE</code>, returns table of read counts per barcode. If <code>FALSE</code>, returns <code>TapestriExperiment.</code> Default <code>FALSE</code>.</p></dd>


<dt id="arg-max-mismatch">max.mismatch<a class="anchor" aria-label="anchor" href="#arg-max-mismatch"></a></dt>
<dd><p>Numeric, the maximum and minimum number of mismatching letters allowed. Default 2.</p></dd>


<dt id="arg-with-indels">with.indels<a class="anchor" aria-label="anchor" href="#arg-with-indels"></a></dt>
<dd><p>If <code>TRUE</code>, then indels are allowed. Default <code>FALSE</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arguments to pass on to <code>countBarcodedReadsFromContig()</code>.</p></dd>


<dt id="arg-contig">contig<a class="anchor" aria-label="anchor" href="#arg-contig"></a></dt>
<dd><p>Character, contig or chromosome name to search for barcodes in. Can be a vector of more than one contig to expand search space.</p></dd>


<dt id="arg-cell-barcode-tag">cell.barcode.tag<a class="anchor" aria-label="anchor" href="#arg-cell-barcode-tag"></a></dt>
<dd><p>Character of length 2, indicates cell barcode field in BAM, specified by Tapestri pipeline (currently "RG"). Default "RG".</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>TapestriExperiment</code> with barcoded read counts added to <code>colData</code>.</p>
<p>A data.frame of read counts for each specified barcode.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/Rsamtools/man/scanBam.html" class="external-link">Rsamtools::indexBam()</a></code></p>
<p><code><a href="https://rdrr.io/pkg/Biostrings/man/matchPattern.html" class="external-link">Biostrings::matchPattern()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">counts</span> <span class="op">&lt;-</span> <span class="fu">countBarcodedReads</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">TapestriExperiment</span>,</span></span>
<span class="r-in"><span>  <span class="va">bam.file</span>, <span class="va">barcode.lookup</span>, <span class="st">"gRNA"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">counts</span> <span class="op">&lt;-</span> <span class="fu">countBarcodedReadsFromContig</span><span class="op">(</span><span class="va">bam.file</span>, <span class="va">barcode.lookup</span>, <span class="st">"virus_ref2"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Joseph Mays.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

